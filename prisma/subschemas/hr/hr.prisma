// TODO: LEAVE, APPRAISAL, JOB, AWARDS, PAYSLIP, TIMESHEET, ATTENDANCE, CONTRACT, EMPLOYEE DOCUMENT, COMPAINT,

model Employee {
  id            String    @id @default(cuid())
  fullName      String?
  displayName   String?
  email         String?
  birthDate     DateTime?
  gender        String?
  contactNumber String?
  address       Json?

  image         String?
  salary        Float?
  dateJoined    DateTime?
  leaveDate     DateTime?
  bloodGroup    String?
  ethnicRace    String?
  maritalStatus String?
  isActive      Boolean   @default(true)

  role EmployeeRole @default(MEMBER)

  userId String
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  workspaceId String
  workspace   Workspace @relation(fields: [workspaceId], references: [id], onDelete: Cascade)

  spaces            Space[]
  subtasks          Subtask[]
  taskComments      TaskComment[]
  taskHistory       TaskHistory[]
  departmentCreator Department[]

  taskCreator     Task[]     @relation("TaskCreator")
  taskFiles       TaskFile[]
  projectCreator  Project[]  @relation("ProjectCreator")
  assignedManager Project[]  @relation("AssignedManager")

  employeeDepartment EmployeeDepartment[]
  invite             Invite[]

  TaskCollaborator    TaskCollaborator[]
  ProjectCollaborator ProjectCollaborator[]
  subtaskCollaborator SubtaskCollaborator[]

  attendance Attendance[]
  leave      Leave[]
  Education  Education[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([userId, workspaceId, fullName, email, gender])
}

model Department {
  id    String  @id @default(cuid())
  name  String  @unique
  alias String?

  employeeId        String
  departmentCreator Employee @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  workspaceId        String
  workspace          Workspace            @relation(fields: [workspaceId], references: [id], onDelete: Cascade)
  employeeDepartment EmployeeDepartment[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([employeeId, workspaceId, name])
}

model EmployeeDepartment {
  id           String       @id @default(cuid())
  employeeId   String
  departmentId String
  role         EmployeeRole @default(MEMBER)

  employee   Employee   @relation(fields: [employeeId], references: [id])
  department Department @relation(fields: [departmentId], references: [id])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Attendance {
  id            String           @id @default(cuid())
  punchInTime   DateTime
  punchOutTime  DateTime?
  ip            String?
  comment       String?
  punchBy       Int?
  totalHour     Float?
  inTimeStatus  String?
  outTimeStatus String?
  state         AttendanceStatus
  employeeId    String
  employee      Employee         @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Leave {
  id String @id @default(cuid())

  appliedDate   DateTime       @default(now())
  startDate     DateTime
  endDate       DateTime
  acceptedDate  DateTime?
  duration      Int
  reason        String?
  leaveType     LeaveType[]
  reviewComment LeaveComment[]
  status        LeaveStatus    @default(PENDING)

  employeeId String
  employee Employee @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Education {
  id String @id @default(cuid())

  institution   String?
  courseOfStudy String?
  result        String?
  degree        String?
  startDate     DateTime?
  endDate       DateTime?
  status        Boolean   @default(true)

  employeeId String
  employee   Employee @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model PaySlip {
  id                   String        @id @default(cuid())
  netPayble            Float
  basicSalary          Float
  salaryMonth          String
  status               PaymentStatus @default(UNPAID)
  allowance            Float
  commission           Float
  loan                 Float
  saturation_deduction Float
  other_payment        Float
  overtime             Float
  created_by           String
  employee_id          String
  employee             Employee      @relation(fields: [employee_id], references: [id])
}

model LeaveComment {
  id String @id @default(cuid())

  comments String

  employeeId String
  employee   Employee @relation(fields: [employeeId], references: [id])

  leave   Leave?  @relation(fields: [leaveId], references: [id])
  leaveId String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model LeaveType {
  id    String @id @default(cuid())
  title String

  employeeId String
  employee   Employee @relation(fields: [employeeId], references: [id])

  leave   Leave?  @relation(fields: [leaveId], references: [id])
  leaveId String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model PerformanceAppraisal {
  id String @id @default(cuid())

  appraisalDate      DateTime
  rating             Float
  comments           String
  goals              String
  achievements       String
  managerComments    String
  appraisalQuestions Json
}

model AppraisalResponse {
  id String @id @default(cuid())

  appraisalId          String
  performanceAppraisal PerformanceAppraisal @relation(fields: [appraisalId], references: [id])

  question String
  response String
}

// Job Board 
model Job {
  id            String    @id @default(cuid())
  title         String
  description   String
  email         String
  address       String
  salaryRange   Int
  noOfPositions Int
  company       String
  types         String
  education     String
  industry      String
  experience    String
  employee      Employee? @relation(fields: [employeeId], references: [id])
  employeeId    String?
  createdAt     DateTime  @default(now()) @map(name: "created_at")
  updatedAt     DateTime  @updatedAt @map(name: "updated_at")
}

enum PaymentStatus {
  UNPAID
  PAID
}

enum AttendanceStatus {
  PUNCHED_IN
  PUNCHED_OUT
}

enum LeaveStatus {
  PENDING
  APPROVED
  REJECTED
}
